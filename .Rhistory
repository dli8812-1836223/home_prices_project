SF_data$`2014/01`,
SF_data$`2014/02`,
SF_data$`2014/03`,
SF_data$`2014/04`,
SF_data$`2014/05`,
SF_data$`2014/06`,
SF_data$`2014/07`,
SF_data$`2014/08`,
SF_data$`2014/09`,
SF_data$`2014/10`,
SF_data$`2014/11`,
SF_data$`2014/12`,
SF_data$`2015/01`,
SF_data$`2015/02`,
SF_data$`2015/03`,
SF_data$`2015/04`,
SF_data$`2015/05`,
SF_data$`2015/06`,
SF_data$`2015/07`,
SF_data$`2015/08`,
SF_data$`2015/09`,
SF_data$`2015/10`,
SF_data$`2015/11`,
SF_data$`2015/12`,
SF_data$`2016/01`,
SF_data$`2016/02`,
SF_data$`2016/03`,
SF_data$`2016/04`,
SF_data$`2016/05`,
SF_data$`2016/06`,
SF_data$`2016/07`,
SF_data$`2016/08`,
SF_data$`2016/09`,
SF_data$`2016/10`,
SF_data$`2016/11`,
SF_data$`2016/12`,
SF_data$`2017/01`,
SF_data$`2017/02`,
SF_data$`2017/03`,
SF_data$`2017/04`,
SF_data$`2017/05`,
SF_data$`2017/06`,
SF_data$`2017/07`,
SF_data$`2017/08`,
SF_data$`2017/09`,
SF_data$`2017/10`,
SF_data$`2017/11`,
SF_data$`2017/12`,
SF_data$`2018/01`,
SF_data$`2018/02`,
SF_data$`2018/03`,
SF_data$`2018/04`,
SF_data$`2018/05`,
SF_data$`2018/06`,
SF_data$`2018/07`,
SF_data$`2018/08`,
SF_data$`2018/09`,
SF_data$`2018/10`,
SF_data$`2018/11`,
SF_data$`2018/12`,
SF_data$`2019/01`),
"United States" = list(US_data$`2010/01`,
US_data$`2010/02`,
US_data$`2010/03`,
US_data$`2010/04`,
US_data$`2010/05`,
US_data$`2010/06`,
US_data$`2010/07`,
US_data$`2010/08`,
US_data$`2010/09`,
US_data$`2010/10`,
US_data$`2010/11`,
US_data$`2010/12`,
US_data$`2011/01`,
US_data$`2011/02`,
US_data$`2011/03`,
US_data$`2011/04`,
US_data$`2011/05`,
US_data$`2011/06`,
US_data$`2011/07`,
US_data$`2011/08`,
US_data$`2011/09`,
US_data$`2011/10`,
US_data$`2011/11`,
US_data$`2011/12`,
US_data$`2012/01`,
US_data$`2012/02`,
US_data$`2012/03`,
US_data$`2012/04`,
US_data$`2012/05`,
US_data$`2012/06`,
US_data$`2012/07`,
US_data$`2012/08`,
US_data$`2012/09`,
US_data$`2012/10`,
US_data$`2012/11`,
US_data$`2012/12`,
US_data$`2013/01`,
US_data$`2013/02`,
US_data$`2013/03`,
US_data$`2013/04`,
US_data$`2013/05`,
US_data$`2013/06`,
US_data$`2013/07`,
US_data$`2013/08`,
US_data$`2013/09`,
US_data$`2013/10`,
US_data$`2013/11`,
US_data$`2013/12`,
US_data$`2014/01`,
US_data$`2014/02`,
US_data$`2014/03`,
US_data$`2014/04`,
US_data$`2014/05`,
US_data$`2014/06`,
US_data$`2014/07`,
US_data$`2014/08`,
US_data$`2014/09`,
US_data$`2014/10`,
US_data$`2014/11`,
US_data$`2014/12`,
US_data$`2015/01`,
US_data$`2015/02`,
US_data$`2015/03`,
US_data$`2015/04`,
US_data$`2015/05`,
US_data$`2015/06`,
US_data$`2015/07`,
US_data$`2015/08`,
US_data$`2015/09`,
US_data$`2015/10`,
US_data$`2015/11`,
US_data$`2015/12`,
US_data$`2016/01`,
US_data$`2016/02`,
US_data$`2016/03`,
US_data$`2016/04`,
US_data$`2016/05`,
US_data$`2016/06`,
US_data$`2016/07`,
US_data$`2016/08`,
US_data$`2016/09`,
US_data$`2016/10`,
US_data$`2016/11`,
US_data$`2016/12`,
US_data$`2017/01`,
US_data$`2017/02`,
US_data$`2017/03`,
US_data$`2017/04`,
US_data$`2017/05`,
US_data$`2017/06`,
US_data$`2017/07`,
US_data$`2017/08`,
US_data$`2017/09`,
US_data$`2017/10`,
US_data$`2017/11`,
US_data$`2017/12`,
US_data$`2018/01`,
US_data$`2018/02`,
US_data$`2018/03`,
US_data$`2018/04`,
US_data$`2018/05`,
US_data$`2018/06`,
US_data$`2018/07`,
US_data$`2018/08`,
US_data$`2018/09`,
US_data$`2018/10`,
US_data$`2018/11`,
US_data$`2018/12`,
US_data$`2019/01`),
"Chicago" = list(Chicago_data$`2010/01`,
Chicago_data$`2010/02`,
Chicago_data$`2010/03`,
Chicago_data$`2010/04`,
Chicago_data$`2010/05`,
Chicago_data$`2010/06`,
Chicago_data$`2010/07`,
Chicago_data$`2010/08`,
Chicago_data$`2010/09`,
Chicago_data$`2010/10`,
Chicago_data$`2010/11`,
Chicago_data$`2010/12`,
Chicago_data$`2011/01`,
Chicago_data$`2011/02`,
Chicago_data$`2011/03`,
Chicago_data$`2011/04`,
Chicago_data$`2011/05`,
Chicago_data$`2011/06`,
Chicago_data$`2011/07`,
Chicago_data$`2011/08`,
Chicago_data$`2011/09`,
Chicago_data$`2011/10`,
Chicago_data$`2011/11`,
Chicago_data$`2011/12`,
Chicago_data$`2012/01`,
Chicago_data$`2012/02`,
Chicago_data$`2012/03`,
Chicago_data$`2012/04`,
Chicago_data$`2012/05`,
Chicago_data$`2012/06`,
Chicago_data$`2012/07`,
Chicago_data$`2012/08`,
Chicago_data$`2012/09`,
Chicago_data$`2012/10`,
Chicago_data$`2012/11`,
Chicago_data$`2012/12`,
Chicago_data$`2013/01`,
Chicago_data$`2013/02`,
Chicago_data$`2013/03`,
Chicago_data$`2013/04`,
Chicago_data$`2013/05`,
Chicago_data$`2013/06`,
Chicago_data$`2013/07`,
Chicago_data$`2013/08`,
Chicago_data$`2013/09`,
Chicago_data$`2013/10`,
Chicago_data$`2013/11`,
Chicago_data$`2013/12`,
Chicago_data$`2014/01`,
Chicago_data$`2014/02`,
Chicago_data$`2014/03`,
Chicago_data$`2014/04`,
Chicago_data$`2014/05`,
Chicago_data$`2014/06`,
Chicago_data$`2014/07`,
Chicago_data$`2014/08`,
Chicago_data$`2014/09`,
Chicago_data$`2014/10`,
Chicago_data$`2014/11`,
Chicago_data$`2014/12`,
Chicago_data$`2015/01`,
Chicago_data$`2015/02`,
Chicago_data$`2015/03`,
Chicago_data$`2015/04`,
Chicago_data$`2015/05`,
Chicago_data$`2015/06`,
Chicago_data$`2015/07`,
Chicago_data$`2015/08`,
Chicago_data$`2015/09`,
Chicago_data$`2015/10`,
Chicago_data$`2015/11`,
Chicago_data$`2015/12`,
Chicago_data$`2016/01`,
Chicago_data$`2016/02`,
Chicago_data$`2016/03`,
Chicago_data$`2016/04`,
Chicago_data$`2016/05`,
Chicago_data$`2016/06`,
Chicago_data$`2016/07`,
Chicago_data$`2016/08`,
Chicago_data$`2016/09`,
Chicago_data$`2016/10`,
Chicago_data$`2016/11`,
Chicago_data$`2016/12`,
Chicago_data$`2017/01`,
Chicago_data$`2017/02`,
Chicago_data$`2017/03`,
Chicago_data$`2017/04`,
Chicago_data$`2017/05`,
Chicago_data$`2017/06`,
Chicago_data$`2017/07`,
Chicago_data$`2017/08`,
Chicago_data$`2017/09`,
Chicago_data$`2017/10`,
Chicago_data$`2017/11`,
Chicago_data$`2017/12`,
Chicago_data$`2018/01`,
Chicago_data$`2018/02`,
Chicago_data$`2018/03`,
Chicago_data$`2018/04`,
Chicago_data$`2018/05`,
Chicago_data$`2018/06`,
Chicago_data$`2018/07`,
Chicago_data$`2018/08`,
Chicago_data$`2018/09`,
Chicago_data$`2018/10`,
Chicago_data$`2018/11`,
Chicago_data$`2018/12`,
Chicago_data$`2019/01`)
)
chartTitle <- switch(input$city,
"Seattle, WA" = "Seattle",
"Los Angeles-Long Beach-Anaheim, CA" = "Los Angeles",
"New York, NY" = "New York",
"Chicago, IL" = "Chicago",
"San Francisco, CA" = "San Francisco",
"United States" = "United States"
)
Pure_city_data_points <- select(City_data, -RegionName, -SizeRank)
Xvalues <- filter(City_data, SizeRank == "size") %>% select(-RegionName, -SizeRank)
yrange <- c(0,3500)
xrange <- range(num_year)
plot(xrange,yrange,type="n",xlab="",ylab="Rental Prices (in Dollars)",cex.lab=1.5,
main=paste("Changes in Rental Prices in ", chartTitle))
lines(Xvalues,chartData,col="firebrick3",lwd=3)
legend(2010,3450,c("Rental Price Trends"),
col="firebrick3", pch=15,ncol=300,bty ="n",cex=1.1)
}, height = 600, width = 700)
#closes candances output
output$scatter <- renderPlotly({
rents_year <- rents_year %>%
filter(rents_year[[input$area]] > input$price_range[1],
rents_year[[input$area]] < input$price_range[2])
scatter_plot <- plot_ly(rents_year) %>%
add_trace(x = rents_year$SizeRank,
y = rents_year[[input$area]],
type = "scatter",
mode = "markers",
hoverinfo = "text",
color = rents_year[[input$area]],
colors = c("blue", "red"),
text = ~paste0(RegionName, "<br>",
"Average Rental Price: $",
round(rents_year[[input$area]], digits = 2),
"<br>",
"Size Rank: ", rents_year$SizeRank)) %>%
layout(title = "Price vs Area",
xaxis = list(title = "Size Rank"),
yaxis = list(title = "Rental Price ($)",
showlegend = FALSE))
if (input$box) {
scatter_plot <-
add_lines(scatter_plot, x = rents_year$SizeRank, y = ~fitted(
loess(rents_year[[input$area]] ~ rents_year$SizeRank)),
line = list(color = "black"),
name = "Trendline",
showlegend = FALSE)
}
colorbar(scatter_plot,
title = "Rental Price ($)")
scatter_plot
})
output$histogram <- renderPlot({
return(histogram(three, input$city1, input$city2))
})
})
ui <- shinyUI(navbarPage(
"Rental Prices",
tabPanel(
"Project Introduction",
p("Introduction
The current housing shortage is affecting people nationwide, as prices
have continued to skyrocket in the past few years. Potential buyers are
forced to rent for longer periods of time, as the competitive market and
rising rates will not allow for affordability to emerging independents.
More and more people are forced to live with several others or move home
with parents, as they are tired of paying for something they are never
going to own. To provide context, rents in the third quarter of 2018 were
up 2.9 percent compared with a year ago. As college students, we are
always concerned about where we can find the best cost-efficient housing.
Thus, we decided to explore a dataset with housing rental prices.
Our Audience
Our primary target audience is college students who are planning to
graduate and are unsure where they may live next year. During their
searches for employment, that may mean they need to live outside their
homes, and thus need to find a place to stay. Providing rental prices for
locations nationally will give people an idea of where they might
consider living.
Inspirations to look deeper
With rising prices in the housing market, there are plenty of unanswered
questions that can be answered through out data sets.
Some questions we believe could be answered include:
- Is there a relationship between size of the city and rental prices?
- What region has more expensive rental prices?
- Where have housing prices been more static and changing?",
a("zillow", href="https://www.zillow.com/research/data/")
)
),
tabPanel(
"US Map",
titlePanel("Rent Prices By State"),
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "year_var",
label = h3("Select Year"),
choices = list(
"2019 Rent Prices" = "2019/01",
"2018 Rent Prices" = "2018/01",
"2017 Rent Prices" = "2017/01",
"2016 Rent prices" = "2016/01",
"2015 Rent Prices" = "2015/01"
),
selected = "2019 Rent Prices"
)
),
mainPanel(
leafletOutput("rents_map"),
p("This is a choropleth map of the United States and the state average
rent prices. The data displayed currently is the rent prices collected
from 2019. In the side panel bar, you (as the user) can choose to
examine data from the previous 5 years. The map is color coded into 9
different price ranges, which also correlates to the legend displayed
in the bottom right corner.")
)
)
), #closes tab panel 1
tabPanel("Line Graph",
titlePanel("Changes in Home Prices"),
sidebarLayout(
sidebarPanel(
radioButtons("city", label = h3("Select the City"),
choices = list(
"United States" = "United States",
"Seattle, WA" = "Seattle",
"Los Angeles-Long Beach-Anaheim, CA" = "Los Angeles",
"New York, NY" = "New York",
"Chicago, IL" = "Chicago",
"San Francisco, CA" = "San Francisco"),
selected = "United States")
),
mainPanel(
plotOutput("linechart")
)
)
),
tabPanel("Price by Area",
titlePanel("Rental Price by Size Rank, Per Year"),
sidebarLayout(
sidebarPanel(
selectInput("area",
label = "Year to Analyze",
choices = list("2010" = "mean_2010",
"2011" = "mean_2011",
"2012" = "mean_2012",
"2013" = "mean_2013",
"2014" = "mean_2014",
"2015" = "mean_2015",
"2016" = "mean_2016",
"2017" = "mean_2017",
"2018" = "mean_2018",
"2019" = "mean_2019"),
selected = "mean_2019"),
sliderInput("price_range",
label = "Range of Rental Price",
min = min(min_list),
max = max(max_list),
value = c(min(min_list),
max(max_list))),
checkboxInput("box",
label = "Show Trendline",
value = TRUE)
),
mainPanel(plotlyOutput("scatter"),
p("The chart above depicts the relationship between each city's
size rank, their size ranked in the top 350 biggest cities,
and the average rental price in the given year. The data
includes the average of the United States as a whole as the
marker with a size rank of 0. The relationship shows that the
more sizable cities are more expensive on average, with a few
outliers. This is especially true in the top 50 cities, where
there is a sudden rise in average rental price.")))),
tabPanel(
"Histogram",
titlePanel("Rental Prices on the West Coast in 2019"),
sidebarPanel(
selectInput(
"city1",
label = "Select a city",
choices = list(
"Seattle" = "Seattle, WA",
"San Francisco" = "San Francisco, CA",
"Fresno" = "Fresno, CA",
"Portland" = "Portland, OR",
"Los Angeles" = "Los Angeles-Long Beach-Anaheim, CA",
"Las Vegas" = "Las Vegas, NV",
"Olympia" = "Olympia, WA",
"Vallejo" = "Vallejo, CA",
"Santa Cruz" = "Santa Cruz, CA",
"Bellingham" = "Bellingham, WA",
"Napa" = "Napa, CA",
"San Jose" = "San Jose, CA",
"San Luis Obispo" = "San Luis Obispo, CA"
),
selected = "Seattle, WA"
),
selectInput(
"city2",
label = "Select another city",
choices = list(
"Seattle" = "Seattle, WA",
"San Francisco" = "San Francisco, CA",
"Fresno" = "Fresno, CA",
"Portland" = "Portland, OR",
"Los Angeles" = "Los Angeles-Long Beach-Anaheim, CA",
"Las Vegas" = "Las Vegas, NV",
"Olympia" = "Olympia, WA",
"Vallejo" = "Vallejo, CA",
"Santa Cruz" = "Santa Cruz, CA",
"Bellingham" = "Bellingham, WA",
"Napa" = "Napa, CA",
"San Jose" = "San Jose, CA",
"San Luis Obispo" = "San Luis Obispo, CA"
),
selected = "San Francisco, CA"
)
),
mainPanel(
plotOutput("histogram"),
p("We created a histogram that allowed people to compare rental prices of
two cities on the West Coast in 2019. Because many students at the
University of Washington would like to stay on the West Coast, we
decided to filter out cities in the Midwest and East because those
regions are not as relevant to students here. From this histogram,
people can see if size and the notability of the city name impacts the
rental prices. We will be able to better assess where on the West Coast
would be the least costly.")
)
) #closes tab panel
))
shinyApp(ui, server)
shinyApp(ui, server)
